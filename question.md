## 简单说项⽬做了什么

这是⼀个分布式的数据存储项⽬，其中⽤到了消息队列RabbitMQ、ES。可以将客户端上传的数据随机保存到任意
⼀个储存节点，并且根据⽂件的⼤⼩选择不同的上传策略，包括分⽚存储、断点续传等。

## 消息队列扮演了什么⻆⾊

RabbitMQ在项⽬中起到了解耦的作⽤，通过增加⼀层使业务API和实际操作的数据存储API分离开，中间通过消息
队列连接。消息队列相当于⼀个银⾏服务员，当客户端来的时候，业务员查询后台可以做存储的服务器节点，并且
随机挑选一个将地址拿到，然后从客户端⼿中将要办理存储业务的数据也拿到，按照刚才拿到的地址找到存储服务
器进行存储.并且RabbitMQ可以通过设计⼀个⼼跳消息，不断管理存储节点，如果发现节点挂掉，及时将节点从列表中剔除，
保证服务的可⽤性。

## ES有什么⽤？

因为我们在上传的时候要避免重复上传，并且完成数据校验保证上传数据的完整性。所以需要⼀个东⻄去保存哈希
值与其名字的对应关系
显然不能存在内存⾥，所以需要⼀个分布式数据库去进⾏存储，然后在GET对象时候通过查询ES拿到其存储信息。
Redis也可以实现你说的功能，为什么⽤ES？
Redis也可以实现分布式存储，但它与ES的侧重点不同，⾸先Redis是基于内存的，虽然也有持久化机制但仍然存在
潜在问题，⽐如短时间内存⼊⼤量数据是否会导致内存不⾜？⽽且Redis主要做的是key-value存储，并不是传统意
义的数据库，ES可以通过⼀个key存储更多的消息，这更适合我们的场景。⽽且ES在搜索上⽐Redis速度更快

## 断点续传

在http header中设置range表示当前文件分片的起始位置，文件size始终为整个文件的size,文件hash也始终为整个文件的hash,
只有在整个文件都被写入到dataServer中之后，我们才会校验写入的文件hash和http传过来的文件hash是否相同

## 数据校验是怎么做的

前端获取文件hash值，我们在上传的时候并不是直接将对象存⼊节点中，⽽是将其⾸先设置成⼀个缓存，这是逻辑上的缓存，我们在上传
前，客户端要提前告知其哈希值、size等信息，然后等存储节点将数据接受完毕以后，计算接收到的哈希值和
size，与其将客户端告知的进⾏对⽐，如果⼀致，说明数据没问题，将其转正。如果有问题那么⽴即删除对象。

## 文件过大，无法放入内存中，如何处理

当文件过大时，比如大于1G,直接在前端或客户端设置断点续传式的发送，以1M或其他大小为单位进行上传，执行断点续传的逻辑，并在每一次
发送时在http header中设置range参数，从根本上解决这个问题

## 如果有⼀个存储节点挂掉了怎么办？

没有影响，因为我们虽然是随机选取⼀个节点进⾏存储，但实际上还做了数据冗余防⽌节点挂掉数据丢失。即在其
他节点进⾏⼀些副本的存储作为备⽤，为了进⼀步节省空间，采⽤了RS纠删码进⾏实现。

## 分布式数据库和分布式集群数据库什么区别？

分布式数据库是为了把数据分散到不同的节点上，节点的数据不同，是为了均摊分散
分布式集群是将同样的数据复制好多份到不同节点上，是为了容灾
本⽂采⽤分布式数据库，搭配RS纠删码也可以通过数据恢复实现容灾机制

## CAP理论

它是指⼀个分布式系统最多只能同时满⾜⼀致性（Consistency）、可⽤性（Availability）和分区容错性
（Partition tolerance）这三项中的两项。
参考资料：https://cloud.tencent.com/developer/article/1860632

## 分布式集群中选举机制

选举算法主要是根据RAFT、ZAB和Paxos进⾏设计，各个框架的具体实现不同
（这⾥可以聊这三个算法的流程，资料很多⾃⼰查⼀下）

## Raft相关问题

leader挂掉怎么办？
leader挂掉⼜好了？
同时两个leader怎么办？
出现分区怎么办？
⼼跳机制的设计原则？
这些问题raft协议论⽂⾥写的都很明⽩。
